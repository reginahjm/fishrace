<html>
  <head>
    <link rel="stylesheet" type="text/css" href="style.css">
  </head>
  <body>
    <p id="texthere"></p>

    <div id="pool">

      <!-- vertical lines  -->
<!--       <div class ="lines line-1"></div>
      <div class ="lines line-2"></div>
      <div class ="lines line-3"></div> -->

      <!-- player 1 -->
      <div id="fish1">
        <div id="body-1" class="fishbodies-pattern"></div>
        <div class="fishbodies">
          <div class="eye">
            <div class="pupil"></div>
          </div>
        </div>
          <div class="fin"></div>
          <div class="fin fin-bottom"></div>
      </div>

      <!-- player 2 -->
      <div id="fish2">
        <div id="body-2" class="fishbodies-pattern"></div>
        <div class="fishbodies" >
          <div class="eye">
              <div class="pupil"></div>
           </div>
        </div>
        <div class="fin"></div>
        <div class="fin fin-bottom"></div>
      </div>

      <!-- player 3 -->
      <div id="fish3">
        <div class="fishbodies" id="body-3">
          <div class="eye">
              <div class="pupil"></div>
           </div>
        </div>
        <div class="fin"></div>
        <div class="fin fin-bottom"></div>
      </div>

      <!-- player 4 -->
      <div id="fish4">
        <div class="fishbodies" id="body-4">
          <div class="eye">
             <div class="pupil"></div>
           </div>
        </div>
         <div class="fin"></div>
        <div class="fin fin-bottom"></div>

      </div>

      <!-- Bubble deco -->
      <div class="bubbles bubble-1"></div>

    </div>    
    <div id="startplatform">
    </div>


    <script src="/socket.io/socket.io.js"></script>
    <script type="text/javascript">
      var fish = [];
      var socket = io.connect('http://104.131.169.15:3000');

      socket.on('connect', function(){
        console.log("connected");
      });

      var startposition = 20;
      var counter = 1;
      socket.on('enterRace', function(color, socketid){
        
        var thisfishid = "fish"+counter;
        var thisfishid_ = "body-"+counter;
        var newfish = {
          fishcolor: color,
          id: socketid,
          domid: thisfishid,
          xpos: startposition
        }
        fish.push(newfish);
        console.log(newfish);
        counter++;

        var thisfish = document.getElementById(thisfishid);
        var thisfishbody = document.getElementById(thisfishid_);
        thisfish.style.bottom = 100;
        thisfishbody.style.backgroundColor = color;


        // var thisfish = document.createElement("div");
        // document.body.appendChild(thisfish);
        // thisfish.id = socketid;
        // thisfish.style.position = "absolute";
        // thisfish.style.width = "50px";
        // thisfish.style.height = "50px";
        // thisfish.style.left = startposition;
        // thisfish.style.bottom = 100;
        // thisfish.style.backgroundColor = color;
        // startposition += 100;

      });

      socket.on('updateRace', function(newTotalDist, socketid){
        for (var i=0;i<fish.length;i++){
          console.log(socketid+" "+newTotalDist);
          if (fish[i].id == socketid){
            var thisfish = document.getElementById(fish[i].domid); // NEED FIX NEED FIX
            if (newTotalDist >= window.innerHeight-100){
              document.getElementById("texthere").innerHTML = "We have a winner!!";
            } else {
              thisfish.style.bottom = newTotalDist+100;
            }
            break;
          }
        }
      });

      socket.on('takeoutFish', function(socketid){
        var thisfish = document.getElementById(socketid); // NEED FIX NEED FIX
        thisfish.style.display = "none";

      })
    </script>
  </body>
</html>